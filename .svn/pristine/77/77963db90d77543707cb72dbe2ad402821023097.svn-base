666 -->


<link href="/Resources/CSS/question.css" rel="stylesheet" />
<div class="nav-left" id="leftnav" v-cloak>
    <div class="nav-title" @click="showdata">
        <h3><a href="{{IndexUrl}}" style="text-decoration: none; cursor: pointer;">首页</a></h3>
    </div>
    <div v-if="NetWorkClass" class="nav-item">
        <div class="nav-item-title">我的网课</div>
        <ul class="sub-nav">
            <li><a href="/usercenter/onlinecourse/coursemanage.shtml"><i class="iconfont icon-kechengguanli"></i>课程管理</a></li>
            <li><a href="/usercenter/onlinecourse/courserecord.shtml"><i class="iconfont icon-tingkejilu"></i>听课记录</a></li>
        </ul>
    </div>
    <div v-if="Questions" class="nav-item">
        <div class="nav-item-title">我的题库</div>
        <ul class="sub-nav">
            <li><a href="/usercenter/questionbank/tk/myCourseList.shtml"><i class="iconfont icon-kaishizuoti"></i>开始做题</a></li>
            <li><a href="/usercenter/questionbank/QuestionRecord.shtml"><i class="iconfont icon-zuotijilu"></i>做题记录</a></li>
        </ul>
    </div>
    <div v-if="Tuition" class="nav-item">
        <div class="nav-item-title">我的学费</div>
        <ul class="sub-nav">
            <li><a href="/usercenter/finance/financelist.shtml"><i class="iconfont icon-lijijiaofei"></i>立即缴费</a></li>
        </ul>
    </div>
    <div v-if="Educational" class="nav-item">
        <div class="nav-item-title">我的教务</div>
        <ul class="sub-nav">
            <li><a href="/usercenter/educational/myeducational.shtml"><i class="iconfont icon-wodechengji"></i>我的成绩</a></li>
            <li><a href="/usercenter/educational/myexam.shtml"><i class="iconfont icon-wodebaokao"></i>我的报考</a></li>
            <li><a href="/usercenter/educational/mybook.shtml"><i class="iconfont icon-wodeshuji"></i>我的书籍</a></li>
            <li><a href="/usercenter/educational/mycontact.shtml"><i class="iconfont icon-lianxijilu"></i>联系记录</a></li>
        </ul>
    </div>
    <div v-if="Graduation" class="nav-item">
        <div class="nav-item-title">我要毕业</div>
        <ul class="sub-nav">
            <li><i class="iconfont icon-xuexijindu"></i>学习进度</li>
            <li><i class="iconfont icon-lunwendabian"></i>论文答辩</li>
        </ul>
    </div>
    <div v-if="Personal" class="nav-item">
        <div class="nav-item-title">个人管理</div>
        <ul class="sub-nav">
            <li><a href="/usercenter/order/myorder.shtml"><i class="iconfont icon-wodedingdan"></i>我的订单</a></li>
            <li><a href="/usercenter/usermanage/accountsettings.shtml"><i class="iconfont icon-zhanghaoshezhi"></i>账号设置</a></li>
            <li><a href="/usercenter/usermanage/question.shtml"><i class="iconfont icon-tousuyutiwen"></i>投诉提问</a></li>
            <li><a href="/usercenter/usermanage/newsCenter.shtml"><i class="iconfont icon-xiaoxizhongxin"></i>消息中心</a></li>
        </ul>
    </div>
    <div v-if="Process" class="nav-item">
        <div class="nav-item-title">过程性考核</div>
        <ul class="sub-nav">
            <li><i class="iconfont icon-kaishixuexi"></i>开始学习</li>
            <li><a href="/usercenter/process/courseList.shtml"><i class="iconfont icon-peiyangjihua"></i>培养计划</a></li>
            <li><i class="iconfont icon-xuankeguanli"></i>选课管理</li>
            <li><i class="iconfont icon-chengjichaxun"></i>成绩查询</li>
        </ul>
    </div>
    <div v-if="Credit" class="nav-item">
        <div class="nav-item-title">学分互认</div>
        <ul class="sub-nav">
            <li><i class="iconfont icon-kaishixuexi"></i>开始学习</li>
            <li><i class="iconfont icon-peiyangjihua"></i>培养计划</li>
            <li><i class="iconfont icon-xuankeguanli"></i>选课管理</li>
            <li><i class="iconfont icon-chengjichaxun"></i>成绩查询</li>
        </ul>
    </div>
</div>
<script>
    //注释说明
    //    学生返回类型：
    //    1-自考：首页、我的网课、我的题库、我的学费、我的教务、我要毕业、个人管理、过程性考核、学分互认
    //    2-成考：首页、我的网课、我的题库、我的学费、我的教务、我要毕业、个人管理
    //    3-省级系统：首页、个人管理、过程性考核
    //    4-网校:首页、我的网课、我的题库、个人管理

    require_js_file(['table', 'form', 'jquery', 'tableExt', 'element', 'customUtil', 'wxconfig'],
    function (fnr) {
        var $ = layui.$;
        var table = layui.table;
        var tableExt = layui.tableExt;
        var wxconfig = layui.wxconfig;
        new Vue({
            el: "#leftnav",
            data: {
                NetWorkClass: false,//我的网课
                Questions: false,//我的题库
                Tuition: false,//我的学费
                Educational: false,//我的教务
                Graduation: false,//我要毕业
                Personal: false,//个人管理
                Process: false,//过程性考核
                Credit: false,//学分互认
                IndexUrl: '/usercenter/indexStu.shtml',//
                studentinfo: {},
            },
            ready: function () {
               
                var model_id, schooltype;
                var _this = this;
              
                _this.studentinfo = wxconfig.GetStudentInfo();  //获取学生信息
                if (!_this.studentinfo.StuDetail_ID) {
                    _this.IndexUrl = "/usercenter/index.shtml"
                }
                var arr = [];
                if (!_this.getCookie("leftMenu")) {
                    $.get("/service/edu/StudentinfoDetail/CheckStudentCenterLeftMenu", null, function (rsp) {
                        if (rsp.SuccessResponse) {
                            flag = rsp.Data.Flag;
                            stationtype = rsp.Data.StationType;
                            if (flag == 1)//自考&&开启过程性考核
                            {
                                if (stationtype == 2) {
                                    arr = ['NetWorkClass', 'Questions', 'Tuition', 'Educational', 'Graduation', 'Personal', 'Process', 'Credit'];
                                }
                                else if (stationtype == 3) {
                                    arr = ['NetWorkClass', 'Questions', 'Educational', 'Graduation', 'Personal', 'Process', 'Credit'];
                                }
                                else if (stationtype == 4) {
                                    arr = ['NetWorkClass', 'Questions', 'Educational', 'Graduation', 'Personal', 'Process'];
                                }
                            } else if (flag == 2) {//自考&&未开启过程性考核
                                if (stationtype == 2) {
                                    arr = ['NetWorkClass', 'Questions', 'Tuition', 'Educational', 'Graduation', 'Personal', 'Credit'];
                                }
                                else {
                                    arr = ['NetWorkClass', 'Questions', 'Educational', 'Graduation', 'Personal', 'Credit'];
                                }
                            } else if (flag == 3) {//非自考
                                if (stationtype == 2) {
                                    arr = ['NetWorkClass', 'Questions', 'Tuition', 'Educational', 'Graduation', 'Personal'];
                                }
                                else if (stationtype == 1) {//网校
                                    arr = ['NetWorkClass', 'Questions', 'Personal'];
                                }
                                else {
                                    arr = ['NetWorkClass', 'Questions', 'Educational', 'Graduation', 'Personal'];
                                }
                            }
                            arr.map(function (a, b) {
                                _this[a] = true;
                            });
                            _this.setCookie("leftMenu", JSON.stringify(arr));
                        } else {
                            layer.msg("请重新登录~！", { icon: 5 }, function (index) {
                                location.href = "/login.shtml";
                            });
                        }
                    })
                } else {                  
                    $.each(JSON.parse(_this.getCookie("leftMenu")), function () {
                        _this[this] = true;
                    })
                }
            },
            methods: {
                showdata: function () {
                    console.log(this);
                },

                getCookie: function (name) {
                    var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
                    if (arr = document.cookie.match(reg))
                    {  
                        return unescape(arr[2]);
                    }
                    else
                        return null;
                },

                setCookie: function (name, value) {
                    var Days = 30;
                    var exp = new Date();
                    exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
                    document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString() + ";path=/";
                }
            }
        });


    })
</script>
<script>
    require_js_file(['jquery'], function () {
        layui.$(function () {
            var activeMenu = function () {
                var filename = location.href;
                console.log(filename)
                if (typeof activeUrl != 'undefined') {
                    filename = activeUrl;
                }
                reloadClass();
                function getFileName(url) {
                    if (url.indexOf('?') == -1) {
                        return url.substr(url.lastIndexOf('/') + 1)
                    } else {
                        return url.split('?')[0].substr(url.lastIndexOf('/') + 1);
                    }
                }
                //console.log(getFileName(filename));
                function reloadClass() {

                    layui.$("li.active-menu").removeClass("active-menu");
                    console.log(layui.$("a").length)
                    layui.$("a").map(function (a, b) {
                        var aFileName = layui.$(this).prop("href");
                        //console.log("aFileName--" + a + "--" + aFileName)
                        //console.log(layui.$(this).parent())
                        if (getFileName(aFileName) === getFileName(filename) && getFileName(aFileName) !== 'index.shtml') {
                            console.log("here")
                            //console.log(getFileName(filename))
                            layui.$(this).parent().addClass("active-menu");
                        }

                    })
                }
            };

            //layui.$("a").map(function (a, b) {
            //    if (layui.$(a).hasClass("active-menu")) { return }
            //    else {
            //        var filename = location.href.substr(0, location.href.lastIndexOf('/'));
            //        //console.log(filename.substr(filename.lastIndexOf('/') + 1));

            //    }
            //});
            activeMenu();
        })
    });
    //获取当前路径文件名 加上a标签样式
</script>